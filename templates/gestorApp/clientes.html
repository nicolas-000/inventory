{% extends "gestorApp/base.html" %} {% load static %} {% block titulo %}Gestor
de Clientes{% endblock %} {% block css %}<link
  rel="stylesheet"
  href="{% static 'css/dataTables.bootstrap5.min.css' %}"
/>
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>{% endblock %} {% block contenido %}
<div class="container">
  <div class="text-center my-3">
    <h1>Clientes</h1>
  </div>

  <!-- Formulario Cliente -->
  <form class="row g-3" method="POST">
    {% csrf_token %}
    <div class="col-md-12">
      <label for="{{ form.nombreCompleto.label|lower }}" class="form-label">Nombre Completo</label>
      {{ form.nombreCompleto }}
      <div id="nombreCompleto_errors">{{ form.nombreCompleto.errors }}</div>
    </div>
    <div class="col-md-6">
      <label for="{{ form.rut.label|lower }}" class="form-label">Rut</label>
      {{ form.rut }}
      <div id="rut_errors">{{ form.rut.errors }}</div>
    </div>
    <div class="col-md-6">
      <label for="{{ form.email.label|lower }}" class="form-label">Email</label>
      {{ form.email }}
      <div id="email_errors">{{ form.email.errors }}</div>
    </div>
    <div class="col-12">
      <div class="form-check">
        {{ form.checked }}
        <label for="{{ form.checked.label|lower }}" class="form-check-label">Registrar vehículo inmediatamente</label>
      </div>
    </div>

    <!-- Formulario vehículo  -->
    <div class="container row border border-primary-subtle my-3 py-3 rounded bg-info bg-opacity-10 d-none" id="vehiculoCliente">
      <div class="text-center">
        <h3>Vehículo</h3>
      </div>
      <div class="col-md-6">
        <label for="inputPatente" class="form-label">Patente</label>
        <input
          type="text"
          class="form-control"
          id="inputPatente"
          placeholder="AA-BB-00"
        />
      </div>
      <div class="col-md-6">
        <label for="inputMarca" class="form-label">Marca</label>
        <input
          type="text"
          class="form-control"
          id="inputMarca"
          placeholder="Marca"
        />
      </div>
      <div class="col-md-12 mt-2">
        <label for="inputDescripcion" class="form-label">Detalles Vehículo</label>
        <textarea
          type="text"
          class="form-control"
          id="inputDescripcion"
          placeholder="Descripcion"
          rows="2"
        />
        </textarea>
      </div>
    </div>
    <div class="col-4">
      <button type="submit" class="btn btn-primary">Ingresar Cliente</button>
    </div>
    <div class="col-4">
      <!-- <a class="btn btn-warning disabled" href="{% url 'eliminar_cliente' 0 %}" role="button" id="btnEliminar">Eliminar Cliente Seleccionado</a> -->
       <button type="button" class="btn btn-warning disabled" data-url="{% url 'eliminar_cliente' 0 %}" id="btnEliminar">Eliminar Cliente Seleccionado</button>
    </div>
    <div class="col-4 d-flex justify-content-end">
      <button type="button" class="btn btn-light border disabled" id="btnInspeccionar" data-bs-toggle="modal" data-bs-target="#clienteModal">Inspeccionar Cliente Seleccionado</button>
    </div>
  </form>

  <!-- Modal  -->
  <div class="modal fade" id="clienteModal" tabindex="-1" aria-labelledby="clienteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5 text-center" id="clienteModalLabel">Cliente</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Modal body text goes here.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
  

  <!-- Tabla -->
  <div class="my-5">
    <table
      id="clientsTable"
      class="table table-striped table-hover"
      style="width: 100%"
    >
      <thead>
        <tr>
          <th>Rut</th>
          <th>Nombre Completo</th>
          <th>Autos registrados</th>
        </tr>
      </thead>
      <tbody>
        {% for cliente in clientes %}
        <tr>
          <td id="{{ cliente.id }}">{{ cliente.rut }}</td>
          <td>{{ cliente.nombreCompleto }}</td>
          <td>61</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
<script src="{% static 'js/datatables.min.js' %}"></script>
<script src="{% static 'js/clientes.js' %}"></script>
<!-- Script Datatable -->
<script>
  var rut = getUrlParameter("rut");
if (!rut) {
  rut = "";
} else {
  // Mostrar Modal al cargar la pagina
  const myModal = bootstrap.Modal.getOrCreateInstance("#clienteModal");
  myModal.show();
}

$(document).ready(function () {
  $("#clientsTable").DataTable({
    language: {
      url: " {% static 'locale/datatables-plug-ins-2.0.8-i18n-es-CL.json' %}",
    },
    select: {
      style: "single",
      info: false,
    },
    search: {
      search: rut,
    },
  });
});
</script>
{% endblock %}
